# Node Updates

- 2024-10-20 - v18.11.0 -> v18.12.0

# Firebase Updates

- 2024-11-18 - v13.20.2 -> v13.25.0
- 2024-10-17 - v13.20.2 -> v13.22.1 （どうやらインストールできていなかった模様）
- 2024-10-04 - v13.16.0 -> v13.20.2

# Firebase Functions Updates

- 2024-10-24 - ^v5.1.1 -> ^v6.1.0

# System Updates

## 備忘録

- 配置管理での Placement クラスインスタンスの subscribe だが、リソースを節約するために配置データの存在するセルのみ実行しようとするとうまくいかない。制御が複雑になるため、特段の理由がない限りは現行のままでいくこと。

## 課題・要望一覧

1. マスタデータを削除した後、一覧画面に遷移した際に削除したデータが一覧に表示されてしまう。
   -> Vuex が参照している Realtime Database からの削除処理を Cloud Functions が担っているためのタイムラグ。
2. 配置表を開いている人が知りたい。
3. 現場のインポート時、取引先名が知りたい。
4. 従業員マスタに略称カナが必要 -> 従業員選択の絞り込み機能
5. 現場稼働予定に、休工フラグを追加して必要人数を強制的に 0 にする方が良い。
6. 現場並べ替えでダイアログが終了した時にスクロール位置が戻っていない。
7. 現場並べ替えコンポーネントを再利用可能コンポーネントにできそう。

## 2024-11-21 - ver 0.4.0

### 新機能: 稼働予定管理

当月から向こう 5 ヶ月先までの稼働予定をガントチャート風に管理できる機能を実装。
管理者権限（manager）にのみ公開。

### 追加: 配置管理での未上番限定表示

当日未上番である行のみを表示できる機能を実装（ただし、機能追加による混乱を避けるため、非公開）

### 修正: 配置管理/シフト管理

配置管理/シフト管理を以下のように修正

- 前日のシフトは操作不可
- 当日のシフトが登録されている、または既に配置されている場合は強制的にチェック
- 当日のシフトが登録されている場合は操作不可

### 修正: 現場削除時の従属データ同期削除

現場データを削除した時に、当該現場の稼働予定および取極めデータも同期的に削除されるように修正

### その他

- functions
  - ver 0.2.1 でコメントアウトした functions.models.Site の fetchByCode, fetchByCodes を削除
  - ver 0.2.1 でコメントアウトした functions.models.Employee の fetchByCode, fetchByCodes を削除
- components
  - PlacementEmployeeCardV2, PlacementOutsourcerCardV2 を削除
  - layouts.default に定義していた CSS を整理・改修
  - GPlacementTable で当日セルの背景色を黄色に変更
  - Vuex.systems の APP_VERSION を state に移動 -> コンポーネントからアプリのバージョンを確認可能に

## 2024-11-18 - ver 0.3.0

- データを削除するチェックボックスが画面を閉じても初期化されなかったバグを修正
  -> GInputSubmitMixin で保有していた data.forceDelete を GInputInitializeMixin に移設して初期化処理を追加した
- 取引先, 現場, 従業員マスタの詳細画面からデータを削除した場合に、一覧画面へ遷移しないバグを修正
- GDataTableSites の不要なコードを削除
- Realtime Database の取引先, 現場, 従業員のインデックスデータに sync プロパティを追加（要本番環境データ更新）
- ルーターミドルウェアをリファクタリング
  - メンテナンスモードでもアドミニストレーターはアプリを使用可能に（そうでないとテストできない）
  - メンテナンス中にログアウトした際、メンテナンス画面とログイン画面への無限ループが発生してしまうバグを修正
- 取引先, 現場, 従業員の DataTable をリファクタリング
  - Access 版 AirGuard との同期状態をチップコンポーネントで表示するように機能を追加
  - 画面サイズに応じた表示項目の切り替えを整理
- layouts.default.vue に .fixed-height-dialog (css) を追加。
  - dialog コンポーネントの content-class プロパティに適用すると、ダイアログの高さが固定される。
- 配置管理の現場選択コンポーネントを改善
  - 行をクリック（またはタップ）することで現場を選択できるように修正
  - 勤務区分選択をネストさせた別のダイアログで選択するように修正（勤務区分の選択を忘れて submit してしまうのを回避）
- 現場登録用コンポーネントで現場名を入力するとフォーカスが外れたタイミングで略称を自動セットするように改善
- 現場の新規登録時、入力された現場名に類似した既登録現場があった場合にアラートを表示する機能を実装
- 取引先の選択コンポーネント（GAutocompleteCustomer）に表示されるリストが略称カナの昇順になるように修正
- 配置管理でモバイルの場合に勤務指示のテキストをダイアログで表示する機能を追加
- その他細かなリファクタリングを実行

## 2024-11-16 - ver 0.2.1

- models.Site, functions.models.Site で稼働実績の従属設定が `subcollection` になっていたのを修正
- models.Site, functions.models.Site に現場取極めの従属設定がなされていなかったの修正
- functions.models.Site の fetchByCode, fetchByCodes メソッドをコメントアウト -> 未使用
- functions.models.Employee の fetchByCode, fetchByCodes メソッドをコメントアウト -> 未使用

## 2024-11-16 - ver 0.2.0

- 稼働実績の編集画面が tile 表示されるように修正
- GDialogInput がモバイルの時にフルスクリーン表示されるように修正
- GDialogInput が default スロットに tile を追加 / スロットに配置される GInput コンポーネントがモバイルの時に tile 表示になるように
- GCardinputForm の VCardTitle を VToolbar に変更し、レイアウトを調整
- GCheckboxDeleteData の hideDetails の既定値を true に設定
- pages から不要なファイルを削除
- atoms.renderless.ARenderlessCrud.vue を削除
- Vuex.systems をリファクタリング
- Placement クラスが date, siteId, workShift を受け取った途端に subscribe してしまうのを回避
- Placement クラスの date, siteId, workShift プロパティが必須になってしまっていたのを修正
- 日次バッチメンテナンスに（Cloud Functions）配置データの削除処理を追加。暫定で保存日数を 1 週間に設定。
- アプリメンテナンスに配置データの削除処理を実装。

## 2024-11-15 - ver 0.1.0

- 配置管理機能のレイアウトを調整
- 配置管理機能に現場-勤務区分へのジャンプ機能を実装
- 配置管理に関わるコンポーネントのコードをリファクタリング
- 従業員のインデックスに肩書、雇用形態を追加
- GComboboxDate でアイコンクリックでカレンダーが起動するように修正
- 権限管理に `管理者` を追加（既存の `管理者` を `アドミニストレータ` に変更）
- ユーザー管理で `管理者` 権限を制御できるように機能を追加
- 現場管理を管理者権限に公開
- 勤務指示テキストに従業員の肩書を出力するように修正

## 2024-11-14 - ver 0.0.1

- 勤務指示用テキストに肩書を適用するため、従業員管理に肩書を追加
