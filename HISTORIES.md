# 実装計画

## 雇用契約満了アラート

- `pages.index`の雇用契約満了アラートをコンポーネント化？
- `GEmployeeContractsManager`で、雇用契約満了対象の場合にアラート表示を追加。

## リアルタイムリスナーによる Vuex のマスタデータ読み込み件数抑制

2024-07-25 現在、現場（Sites）については稼働状況が`稼働中`であるものを Vuex で subscribe するようになったが、現時点で 200 件以上の読み込みがある。

- アプリを起動した直後、読み込み件数が多いために画面がフリーズしたような動きをする。
- 一度読み込んでしまえばあとはスムーズ。

読み込みの件数を減少させることが重要。

- 一定期間、稼働のない現場についてアラートを出して稼働終了への更新を促す。
  - 最終稼働日の管理方法を検討しなくてはならない。
  - どちらにしても稼働実績の取り込み・管理機能が完成しないと不可能？

## 現場スケジュールの管理機能実装

各現場の稼働予定を登録・管理できるような機能を実装。

## 雇用契約書の PDF 出力

## 現場取極めの PDF 保存と表示

## 現場ごとのチャット（？）

- 稼働予定に変更が生じた場合に、そのエビデンスなどを残すことが難しかったり、予定を変更・更新した場合に「いつ」、「誰が」、「なぜ」変更・更新したのかの履歴が管理できていない。
- エビデンスとなり得るのは LINE により事業部メンバーからの連絡、MILX からや現場からのメール、電話など。
- Timeline を使った変更履歴で管理できないか？（変更履歴自体はユーザーが入力することを前提）

# 25th July 2024

## 取引先（Customers）の管理機能について一部修正。

### Vuex.customers

- `actions.subscribe`で`status === 'active'`のもののみを抽出するように修正。

### pages.customers.index

- `Vuex.customers`の仕様変更に伴う修正。
- 契約満了の取引先については`取引終了を含める`フラグが`true`になったときに読み込むように。
- 上記フラグの値が変わるたびに読み込みを行うことのないよう、`true`になったらフラグ操作不可に。

### MS 版 AirGuard

- 過去半年間、稼働がなかった現場について稼働状況を`稼働終了`に変更。
- local 環境および dev 環境に Sites を全件更新。

### Vuex.sites

- 新規実装

### plugins.firebase.auth.js

- `Vuex.sites`の`actions.subscribe`および`actions.unsubscribe`を追加。

### pages.sites.index

- `Vuex.sites`の実装により全体的に使用を変更。

# 24th July 2024

## Vuex.employee-contracts

- 雇用契約に関する様々な機能を提供するストアとして新規作成
- `getters/expiringSoon`により、30 日以内に雇用契約満了を迎え、かつ予定されている雇用契約が存在しない雇用契約を取得可能に。
- `getters/current`関数により、指定した雇用契約のドキュメント id が現在有効かつ最新のものかどうかを判断できるように。

## GDataTableEmployeeContracts

- 純粋なデータ表示用コンポーネントに変更。
- 現在有効な雇用契約である場合、契約日の前に`mdi-play`アイコンを表示。

## GEmployeeContracts

- 従業員の雇用契約管理用コンポーネントとして新規に実装。

## GCardEmployee

- 雇用契約に関する機能を削除。

## pages.employees.\_docId

- `GEmployeeContracts`を配置し、雇用契約に対するリアルタイムリスナーを削除。

## GInputEmployeeContract

- `editMode`が`REGIST`以外の時は契約日を編集不可にした。

## pages.index

- 暫定で雇用契約満了アラートの為のコンポーネントを配置。将来改善予定。

# 23th July 2024

## GInputEmployee

- 氏名から略称を自動入力できる機能を実装。
- 登録時や編集時には不要になると思われる退職日と退職事由を削除。退職処理については別途実装する。
